
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Laurent Kempé">
    <title>Mocking .NET framework SmtpClient class - Laurent Kempé</title>
    <meta name="author" content="Laurent Kempé">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Laurent Kempé","sameAs":["https://github.com/laurentkempe","https://twitter.com/laurentkempe","https://www.linkedin.com/in/laurentkempe","https://flickr.com/photos/laurentkempe/"],"image":"https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg"},"articleBody":"This Saturday like the last two I planned to work on my wooden terrace, but with the weather we have for this year’s spring, it was almost impossible. So I replaced that with some development.\nI am using Rhino.Mocks as mock object framework and went to the following solution to mock SmtpClient.\n\n\nCapabilities of Rhino.Mock are to mock interfaces, delegates and virtual methods of classes!\nMy goal was to test my MailService class which use SmtpClient and in particular the method SendAsync, which is not a virtual method. SmtpClient inherit from System.Object so no way to use an interface for the unit test. \nNext step was then to make an interface, ISmtpClient, out of the SmtpClient of the .NET Framework using Reflector for .Net. Then I modified the dependency of my MailService class from SmtpClient of the .NET framework to my interface ISmtpClient.     \nusing System.Net;\nusing System.Net.Mail;\nusing System.Security.Cryptography.X509Certificates;\nusing System.Security.Permissions;\nnamespace TechHeadBrothers.Portal.Services.Mail\n{\n    public interface ISmtpClient\n    {\n        &#x2F;&#x2F; Events\n        event SendCompletedEventHandler SendCompleted;\n        &#x2F;&#x2F; Properties\n        X509CertificateCollection ClientCertificates { get; }\n        ICredentialsByHost Credentials { get; set; }\n        SmtpDeliveryMethod DeliveryMethod { get; set; }\n        bool EnableSsl { get; set; }\n        string Host { get; set; }\n        string PickupDirectoryLocation { get; set; }\n        int Port { get; set; }\n        ServicePoint ServicePoint { get; }\n        int Timeout { get; set; }\n        bool UseDefaultCredentials { get; set; }\n        &#x2F;&#x2F; Methods\n        void Send(MailMessage message);\n        void Send(string from, string recipients, string subject, string body);\n        [HostProtection(SecurityAction.LinkDemand, ExternalThreading &#x3D; true)]\n        void SendAsync(MailMessage message, object userToken);\n        [HostProtection(SecurityAction.LinkDemand, ExternalThreading &#x3D; true)]\n        void SendAsync(string from, string recipients, string subject, string body, object userToken);\n        void SendAsyncCancel();\n    }\n}   \nThen I wrote the class SmtpClientProxy. It is based on the design pattern Proxy. So it basically maintains a reference, and controls access, to the real SmtpClient so it can be used in place of the real SmtpClient.     \nnamespace TechHeadBrothers.Portal.Services.Mail\n{\n    public class SmtpClientProxy : ISmtpClient\n    {\n        private readonly SmtpClient smtpClient;\n        public SmtpClientProxy()\n        {\n            smtpClient &#x3D; new SmtpClient();\n            smtpClient.SendCompleted +&#x3D; smtpClient_SendCompleted;\n        }\n        #region ISmtpClient Members\n        public event SendCompletedEventHandler SendCompleted;\n        public X509CertificateCollection ClientCertificates\n        {\n            get { return smtpClient.ClientCertificates; }\n        }\n        public ICredentialsByHost Credentials\n        {\n            get { return smtpClient.Credentials; }\n            set { smtpClient.Credentials &#x3D; value; }\n        }   \nFinally my MailService class with the dependency injection of ISmtpClient interface and a default constructor using my SmtpClientProxy :     \nnamespace TechHeadBrothers.Portal.Services.Mail\n{\n    &#x2F;&#x2F;&#x2F; \n    &#x2F;&#x2F;&#x2F; Service to deliver Emails\n    &#x2F;&#x2F;&#x2F; \n    public class MailService : IMailService\n    {\n        private readonly ISmtpClient smtpClient;\n        public MailService() : this(new SmtpClientProxy())\n        {\n        }\n        public MailService(ISmtpClient smtpClient)\n        {\n            this.smtpClient &#x3D; smtpClient;\n        }   \nIn my unit test I will use the constructor in which I can specify the mock of ISmtpClient, otherwise I will use the default constructor.\nSo that was for the first issue; having the possibility to mock SmtpClient. Now you certainly have realized the second issue that popped up. In my ISmtpClient I have one event:     \n    public interface ISmtpClient\n    {\n        &#x2F;&#x2F; Events\n        event SendCompletedEventHandler SendCompleted;   \nThis event is for sure also in my proxy class, SmtpClientProxy as it inherit form ISmtpClient. In the constructor of SmtpClientProxy I add an event handler on the SendCompleted event of the SmtpClient. This event handler just fires the event exposed by the proxy class, so that I can have an event handler in MailService class to handle the SendComplete event.     \n        private void smtpClient_SendCompleted(object sender, AsyncCompletedEventArgs e)\n        {\n            if (SendCompleted !&#x3D; null)\n                SendCompleted(sender, e);\n        }   \nNothing really special. But now the question rise! I need to mock ISmtpClient in my unit test. But my MailService SendMailMessage method call the SmtpClient.SendAsync method and also add an event handler to SmtpClient.SendCompleted event.     \n        &#x2F;&#x2F;&#x2F; \n        &#x2F;&#x2F;&#x2F; Sends a MailMessage object using the SMTP settings.\n        &#x2F;&#x2F;&#x2F; \n        &#x2F;&#x2F;&#x2F; Email message to be sent\n        public void SendMailMessage(MailMessage mailMessage)\n        {\n            try\n            {\n                mailMessage.IsBodyHtml &#x3D; true;\n                mailMessage.BodyEncoding &#x3D; Encoding.UTF8;\n                this.message &#x3D; mailMessage;\n                smtpClient.SendCompleted +&#x3D; smtpClient_SendCompleted;\n                smtpClient.SendAsync(mailMessage, null);\n            }\n            catch (SmtpException)\n            {\n                this.OnEmailFailed(mailMessage);\n            }\n        }\n        private void smtpClient_SendCompleted(object sender, AsyncCompletedEventArgs e)\n        {\n            this.OnEmailSent(message);\n        }   \nIn my mock then I need to have the same thing happening, even if I mock the interface ISmtpClient.\nHere is the solution I came to:     \nnamespace TechHeadBrothers.Portal.Services.Tests.Mail\n{\n    [TestFixture]\n    public class MailServiceTest\n    {\n        #region Setup&#x2F;Teardown\n        [SetUp]\n        public void SetUp()\n        {\n            mocks &#x3D; new MockRepository();\n        }\n        #endregion\n        private MockRepository mocks;\n        [Test]\n        public void SendMailMessageRaiseEmailSentEvent()\n        {\n            bool emailSentRaised &#x3D; false;\n            var message &#x3D; new MailMessage(“&#108;&#107;&#x40;&#116;&#101;&#115;&#x74;&#x2e;&#99;&#x6f;&#109;“, “&#109;&#107;&#x40;&#116;&#x65;&#115;&#x74;&#46;&#x63;&#x6f;&#109;“);\n            var smtpClient &#x3D; mocks.Stub&lt;ISmtpClient&gt;();\n            var mailService &#x3D; new MailService(smtpClient);\n            mailService.EmailSent +&#x3D; ((sender, e) &#x3D;&gt; { emailSentRaised &#x3D; true; });\n            using (mocks.Record())\n            {\n                var raiser &#x3D; Expect.Call(() &#x3D;&gt; smtpClient.SendCompleted +&#x3D; null)\n                                   .IgnoreArguments().GetEventRaiser();\n                Expect.Call(() &#x3D;&gt; smtpClient.SendAsync(message, null))\n                      .Do((Action&lt;MailMessage, object&gt;) ((arg1, arg2) &#x3D;&gt; raiser.Raise(message, null)));\n            }\n            using (mocks.Playback())\n            {\n                mailService.SendMailMessage(message);\n                Assert.That(emailSentRaised, Is.EqualTo(true));\n            }\n        }\n    }\n}   \nI create a mock of the interface ISmtpClient. Then I inject this mock into my MailService class. I create a event handler for my MailService.EmailSent event using a lambda. This lambda, if called, will change the boolean value emailSentRaised from false to true. This exactly what I want to test in that unit test; that the EmailSent event is raised.\nThen I get raiser object, a Rhino Mock IEventRaiser, from smtpClient.SendCompleted event.\nFinally I set an expectation on smtpClient.SendAsync method adding a Do() handler that will raise the SendCompleted event.\nLast point is using the mailService object, calling the SendMailMessage method and asserting that my boolean emailSentRaised went from false to true.\nAnd here is the result in ReSharper Unit Test Session window. Green!\n \nUpdate: By the way, I forgot to add a link to a post from Phil Haack “Using Rhino Mocks To Unit Test Events on Interfaces“ and another link to a post from Jean-Paul S. Boodhoo “Raising events (from a mock) using Rhino Mocks“. To great post to read!\n","dateCreated":"2008-06-01T05:41:20+00:00","dateModified":"2010-05-07T05:52:14+00:00","datePublished":"2008-06-01T05:41:20+00:00","description":"This Saturday like the last two I planned to work on my wooden terrace, but with the weather we have for this year’s spring, it was almost impossible. So I replaced that with some development.\nI am using Rhino.Mocks as mock object framework and went to the following solution to mock SmtpClient.","headline":"Mocking .NET framework SmtpClient class","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/"},"publisher":{"@type":"Organization","name":"Laurent Kempé","sameAs":["https://github.com/laurentkempe","https://twitter.com/laurentkempe","https://www.linkedin.com/in/laurentkempe","https://flickr.com/photos/laurentkempe/"],"image":"https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg","logo":{"@type":"ImageObject","url":"https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg"}},"url":"https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/","keywords":"unit test, mock"}</script>
    <meta name="description" content="This Saturday like the last two I planned to work on my wooden terrace, but with the weather we have for this year’s spring, it was almost impossible. So I replaced that with some development. I am us">
<meta property="og:type" content="blog">
<meta property="og:title" content="Mocking .NET framework SmtpClient class">
<meta property="og:url" content="https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/index.html">
<meta property="og:site_name" content="Laurent Kempé">
<meta property="og:description" content="This Saturday like the last two I planned to work on my wooden terrace, but with the weather we have for this year’s spring, it was almost impossible. So I replaced that with some development. I am us">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://farm4.static.flickr.com/3251/2540010420_6643d7e119_o.png">
<meta property="article:published_time" content="2008-06-01T05:41:20.000Z">
<meta property="article:modified_time" content="2010-05-07T05:52:14.000Z">
<meta property="article:author" content="Laurent Kempé">
<meta property="article:tag" content="unit test">
<meta property="article:tag" content="mock">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://farm4.static.flickr.com/3251/2540010420_6643d7e119_o.png">
<meta name="twitter:creator" content="@laurentkempe">
    
    
        
    
    
        <meta property="og:image" content="https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-xanp18hfgaqat0ym80dkogrcygo1j5bxtq13osnhvphakc9y0feqihmpgync.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-64298-8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-64298-8');
    </script>


    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Laurent Kempé
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Laurent Kempé</h4>
                
                    <h5 class="sidebar-profile-bio"><p>I am an experienced Team Leader &amp; Distinguished Solution Architect with a passion for shipping high-quality products by empowering development team and culture toward an agile mindset. I bring technical vision and strategy, leading engineering teams to move product, processes and architecture forward.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/presentations.html"
                            
                            rel="noopener"
                            title="Presentations"
                        >
                        <i class="sidebar-button-icon fa fa-file-powerpoint" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Presentations</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/about-laurent-kempe.html"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/laurentkempe"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://twitter.com/laurentkempe"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Twitter"
                        >
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/laurentkempe"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://flickr.com/photos/laurentkempe/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Flickr"
                        >
                        <i class="sidebar-button-icon fab fa-flickr" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Flickr</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="http://feeds.feedburner.com/laurentkempe"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            Mocking .NET framework SmtpClient class
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2008-06-01T05:41:20+00:00">
	
		    Jun 01, 2008
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>This Saturday like the last two I planned to work on my wooden terrace, but with the weather we have for this year’s spring, it was almost impossible. So I replaced that with some development.</p>
<p>I am using <a target="_blank" rel="noopener" href="http://www.ayende.com/projects/rhino-mocks.aspx">Rhino.Mocks</a> as mock object framework and went to the following solution to mock <a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx">SmtpClient</a>.</p>
<span id="more"></span>

<p>Capabilities of Rhino.Mock are to mock interfaces, delegates and virtual methods of classes!</p>
<p>My goal was to test my MailService class which use <a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx">SmtpClient</a> and in particular the method <a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/x5x13z6h.aspx">SendAsync</a>, which is not a virtual method. SmtpClient inherit from System.Object so no way to use an interface for the unit test. </p>
<p>Next step was then to make an interface, ISmtpClient, out of the SmtpClient of the .NET Framework using <a target="_blank" rel="noopener" href="http://www.aisto.com/roeder/dotnet/">Reflector for .Net</a>. Then I modified the dependency of my MailService class from SmtpClient of the .NET framework to my interface ISmtpClient.<br>  <div style="font-weight: bold; font-size: 10pt; background: black; color: white; font-family: consolas">   </p>
<p><span style="color: #cc7832">using</span> System.Net;</p>
<p><span style="color: #cc7832">using</span> System.Net.Mail;</p>
<p><span style="color: #cc7832">using</span> System.Security.Cryptography.X509Certificates;</p>
<p><span style="color: #cc7832">using</span> System.Security.Permissions;</p>
<p><span style="color: #cc7832">namespace</span> TechHeadBrothers.Portal.Services.Mail</p>
<p>{</p>
<p>    <span style="color: #cc7832">public</span> <span style="color: #cc7832">interface</span> <span style="color: #6897bb">ISmtpClient</span></p>
<p>    {</p>
<p>        <span style="color: gray">&#x2F;&#x2F; Events</span></p>
<p>        <span style="color: #cc7832">event</span> <span style="color: #6897bb">SendCompletedEventHandler</span> SendCompleted;</p>
<p>        <span style="color: gray">&#x2F;&#x2F; Properties</span></p>
<p>        <span style="color: #ffc66d">X509CertificateCollection</span> ClientCertificates { <span style="color: #cc7832">get</span>; }</p>
<p>        <span style="color: #6897bb">ICredentialsByHost</span> Credentials { <span style="color: #cc7832">get</span>; <span style="color: #cc7832">set</span>; }</p>
<p>        <span style="color: #6897bb">SmtpDeliveryMethod</span> DeliveryMethod { <span style="color: #cc7832">get</span>; <span style="color: #cc7832">set</span>; }</p>
<p>        <span style="color: #cc7832">bool</span> EnableSsl { <span style="color: #cc7832">get</span>; <span style="color: #cc7832">set</span>; }</p>
<p>        <span style="color: #cc7832">string</span> Host { <span style="color: #cc7832">get</span>; <span style="color: #cc7832">set</span>; }</p>
<p>        <span style="color: #cc7832">string</span> PickupDirectoryLocation { <span style="color: #cc7832">get</span>; <span style="color: #cc7832">set</span>; }</p>
<p>        <span style="color: #cc7832">int</span> Port { <span style="color: #cc7832">get</span>; <span style="color: #cc7832">set</span>; }</p>
<p>        <span style="color: #ffc66d">ServicePoint</span> ServicePoint { <span style="color: #cc7832">get</span>; }</p>
<p>        <span style="color: #cc7832">int</span> Timeout { <span style="color: #cc7832">get</span>; <span style="color: #cc7832">set</span>; }</p>
<p>        <span style="color: #cc7832">bool</span> UseDefaultCredentials { <span style="color: #cc7832">get</span>; <span style="color: #cc7832">set</span>; }</p>
<p>        <span style="color: gray">&#x2F;&#x2F; Methods</span></p>
<p>        <span style="color: #cc7832">void</span> Send(<span style="color: #ffc66d">MailMessage</span> message);</p>
<p>        <span style="color: #cc7832">void</span> Send(<span style="color: #cc7832">string</span> from, <span style="color: #cc7832">string</span> recipients, <span style="color: #cc7832">string</span> subject, <span style="color: #cc7832">string</span> body);</p>
<p>        [<span style="color: #ffc66d">HostProtection</span>(<span style="color: #6897bb">SecurityAction</span><span style="font-weight: normal">.LinkDemand, ExternalThreading &#x3D; </span><span style="color: #cc7832">true</span>)]</p>
<p>        <span style="color: #cc7832">void</span> SendAsync(<span style="color: #ffc66d">MailMessage</span> message, <span style="color: #cc7832">object</span> userToken);</p>
<p>        [<span style="color: #ffc66d">HostProtection</span>(<span style="color: #6897bb">SecurityAction</span><span style="font-weight: normal">.LinkDemand, ExternalThreading &#x3D; </span><span style="color: #cc7832">true</span>)]</p>
<p>        <span style="color: #cc7832">void</span> SendAsync(<span style="color: #cc7832">string</span> from, <span style="color: #cc7832">string</span> recipients, <span style="color: #cc7832">string</span> subject, <span style="color: #cc7832">string</span> body, <span style="color: #cc7832">object</span> userToken);</p>
<p>        <span style="color: #cc7832">void</span> SendAsyncCancel();</p>
<p>    }</p>
<p>}<br> </div>  </p>
<p>Then I wrote the class SmtpClientProxy. It is based on the <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Proxy_pattern">design pattern Proxy</a>. So it basically maintains a reference, and controls access, to the real SmtpClient so it can be used in place of the real SmtpClient.<br>  <div style="font-weight: bold; font-size: 10pt; background: black; color: white; font-family: consolas">   </p>
<p><span style="color: #cc7832">namespace</span> TechHeadBrothers.Portal.Services.Mail</p>
<p>{</p>
<p>    <span style="color: #cc7832">public</span> <span style="color: #cc7832">class</span> <span style="color: #ffc66d">SmtpClientProxy</span> : <span style="color: #6897bb">ISmtpClient</span></p>
<p>    {</p>
<p>        <span style="color: #cc7832">private</span> <span style="color: #cc7832">readonly</span> <span style="color: #ffc66d">SmtpClient</span> smtpClient;</p>
<p>        <span style="color: #cc7832">public</span> SmtpClientProxy()</p>
<p>        {</p>
<p>            smtpClient &#x3D; <span style="color: #cc7832">new</span> <span style="color: #ffc66d">SmtpClient</span>();</p>
<p>            smtpClient.SendCompleted +&#x3D; smtpClient_SendCompleted;</p>
<p>        }</p>
<p><span style="color: #da4832">        #region</span> ISmtpClient Members</p>
<p>        <span style="color: #cc7832">public</span> <span style="color: #cc7832">event</span> <span style="color: #6897bb">SendCompletedEventHandler</span> SendCompleted;</p>
<p>        <span style="color: #cc7832">public</span> <span style="color: #ffc66d">X509CertificateCollection</span> ClientCertificates</p>
<p>        {</p>
<p>            <span style="color: #cc7832">get</span> { <span style="color: #cc7832">return</span> smtpClient.ClientCertificates; }</p>
<p>        }</p>
<p>        <span style="color: #cc7832">public</span> <span style="color: #6897bb">ICredentialsByHost</span> Credentials</p>
<p>        {</p>
<p>            <span style="color: #cc7832">get</span> { <span style="color: #cc7832">return</span> smtpClient.Credentials; }</p>
<p>            <span style="color: #cc7832">set</span> { smtpClient.Credentials &#x3D; <span style="color: #cc7832">value</span>; }</p>
<p>        }<br> </div>  </p>
<p>Finally my MailService class with the dependency injection of ISmtpClient interface and a default constructor using my SmtpClientProxy :<br>  <div style="font-weight: bold; font-size: 10pt; background: black; color: white; font-family: consolas">   </p>
<p><span style="color: #cc7832">namespace</span> TechHeadBrothers.Portal.Services.Mail</p>
<p>{</p>
<p>    <span style="color: gray">&#x2F;&#x2F;&#x2F;</span><span style="color: green"> </span><span style="color: gray"><summary></span></p>
<p>    <span style="color: gray">&#x2F;&#x2F;&#x2F;</span><span style="color: green"> Service to deliver Emails</span></p>
<p>    <span style="color: gray">&#x2F;&#x2F;&#x2F;</span><span style="color: green"> </span><span style="color: gray"></summary></span></p>
<p>    <span style="color: #cc7832">public</span> <span style="color: #cc7832">class</span> <span style="color: #ffc66d">MailService</span> : <span style="color: #6897bb">IMailService</span></p>
<p>    {</p>
<p>        <span style="color: #cc7832">private</span> <span style="color: #cc7832">readonly</span> <span style="color: #6897bb">ISmtpClient</span> smtpClient;</p>
<p>        <span style="color: #cc7832">public</span> MailService() : <span style="color: #cc7832">this</span>(<span style="color: #cc7832">new</span> <span style="color: #ffc66d">SmtpClientProxy</span>())</p>
<p>        {</p>
<p>        }</p>
<p>        <span style="color: #cc7832">public</span> MailService(<span style="color: #6897bb">ISmtpClient</span> smtpClient)</p>
<p>        {</p>
<p>            <span style="color: #cc7832">this</span><span style="font-weight: normal">.smtpClient &#x3D; smtpClient;</span></p>
<p>        }<br> </div>  </p>
<p>In my unit test I will use the constructor in which I can specify the mock of ISmtpClient, otherwise I will use the default constructor.</p>
<p>So that was for the first issue; having the possibility to mock SmtpClient. Now you certainly have realized the second issue that popped up. In my ISmtpClient I have one event:<br>  <div style="font-weight: bold; font-size: 10pt; background: black; color: white; font-family: consolas">   </p>
<p>    <span style="color: #cc7832">public</span> <span style="color: #cc7832">interface</span> <span style="color: #6897bb">ISmtpClient</span></p>
<p>    {</p>
<p>        <span style="color: gray">&#x2F;&#x2F; Events</span></p>
<p>        <span style="color: #cc7832">event</span> <span style="color: #6897bb">SendCompletedEventHandler</span> SendCompleted;<br> </div>  </p>
<p>This event is for sure also in my proxy class, SmtpClientProxy as it inherit form ISmtpClient. In the constructor of SmtpClientProxy I add an event handler on the SendCompleted event of the SmtpClient. This event handler just fires the event exposed by the proxy class, so that I can have an event handler in MailService class to handle the SendComplete event.<br>  <div style="font-weight: bold; font-size: 10pt; background: black; color: white; font-family: consolas">   </p>
<p>        <span style="color: #cc7832">private</span> <span style="color: #cc7832">void</span> smtpClient_SendCompleted(<span style="color: #cc7832">object</span> sender, <span style="color: #ffc66d">AsyncCompletedEventArgs</span> e)</p>
<p>        {</p>
<p>            <span style="color: #cc7832">if</span> (SendCompleted !&#x3D; <span style="color: #cc7832">null</span>)</p>
<p>                SendCompleted(sender, e);</p>
<p>        }<br> </div>  </p>
<p>Nothing really special. But now the question rise! I need to mock ISmtpClient in my unit test. But my MailService SendMailMessage method call the SmtpClient.SendAsync method and also add an event handler to SmtpClient.SendCompleted event.<br>  <div style="font-weight: bold; font-size: 10pt; background: black; color: white; font-family: consolas">   </p>
<p>        <span style="color: gray">&#x2F;&#x2F;&#x2F;</span><span style="color: green"> </span><span style="color: gray"><summary></span></p>
<p>        <span style="color: gray">&#x2F;&#x2F;&#x2F;</span><span style="color: green"> Sends a MailMessage object using the SMTP settings.</span></p>
<p>        <span style="color: gray">&#x2F;&#x2F;&#x2F;</span><span style="color: green"> </span><span style="color: gray"></summary></span></p>
<p>        <span style="color: gray">&#x2F;&#x2F;&#x2F;</span><span style="color: green"> </span><span style="color: gray"><param name="mailMessage"></span><span style="color: green">Email message to be sent</span><span style="color: gray"></param></span></p>
<p>        <span style="color: #cc7832">public</span> <span style="color: #cc7832">void</span> SendMailMessage(<span style="color: #ffc66d">MailMessage</span> mailMessage)</p>
<p>        {</p>
<p>            <span style="color: #cc7832">try</span></p>
<p>            {</p>
<p>                mailMessage.IsBodyHtml &#x3D; <span style="color: #cc7832">true</span>;</p>
<p>                mailMessage.BodyEncoding &#x3D; <span style="color: #ffc66d">Encoding</span><span style="font-weight: normal">.UTF8;</span></p>
<p>                <span style="color: #cc7832">this</span><span style="font-weight: normal">.message &#x3D; mailMessage;</span></p>
<p>                smtpClient.SendCompleted +&#x3D; smtpClient_SendCompleted;</p>
<p>                smtpClient.SendAsync(mailMessage, <span style="color: #cc7832">null</span>);</p>
<p>            }</p>
<p>            <span style="color: #cc7832">catch</span> (<span style="color: #ffc66d">SmtpException</span>)</p>
<p>            {</p>
<p>                <span style="color: #cc7832">this</span><span style="font-weight: normal">.OnEmailFailed(mailMessage);</span></p>
<p>            }</p>
<p>        }</p>
<p>        <span style="color: #cc7832">private</span> <span style="color: #cc7832">void</span> smtpClient_SendCompleted(<span style="color: #cc7832">object</span> sender, <span style="color: #ffc66d">AsyncCompletedEventArgs</span> e)</p>
<p>        {</p>
<p>            <span style="color: #cc7832">this</span><span style="font-weight: normal">.OnEmailSent(message);</span></p>
<p>        }<br> </div>  </p>
<p>In my mock then I need to have the same thing happening, even if I mock the interface ISmtpClient.</p>
<p>Here is the solution I came to:<br>  <div style="font-weight: bold; font-size: 10pt; background: black; color: white; font-family: consolas">   </p>
<p><span style="color: #cc7832">namespace</span> TechHeadBrothers.Portal.Services.Tests.Mail</p>
<p>{</p>
<p>    [<span style="color: #ffc66d">TestFixture</span>]</p>
<p>    <span style="color: #cc7832">public</span> <span style="color: #cc7832">class</span> <span style="color: #ffc66d">MailServiceTest</span></p>
<p>    {</p>
<p><span style="color: #da4832">        #region</span> Setup&#x2F;Teardown</p>
<p>        [<span style="color: #ffc66d">SetUp</span>]</p>
<p>        <span style="color: #cc7832">public</span> <span style="color: #cc7832">void</span> SetUp()</p>
<p>        {</p>
<p>            mocks &#x3D; <span style="color: #cc7832">new</span> <span style="color: #ffc66d">MockRepository</span>();</p>
<p>        }</p>
<p><span style="color: #da4832">        #endregion</span></p>
<p>        <span style="color: #cc7832">private</span> <span style="color: #ffc66d">MockRepository</span> mocks;</p>
<p>        [<span style="color: #ffc66d">Test</span>]</p>
<p>        <span style="color: #cc7832">public</span> <span style="color: #cc7832">void</span> SendMailMessageRaiseEmailSentEvent()</p>
<p>        {</p>
<p>            <span style="color: #cc7832">bool</span> emailSentRaised &#x3D; <span style="color: #cc7832">false</span>;</p>
<p>            <span style="color: #cc7832">var</span> message &#x3D; <span style="color: #cc7832">new</span> <span style="color: #ffc66d">MailMessage</span>(<span style="color: #a5c25c">“<a href="mailto:&#108;&#107;&#x40;&#116;&#101;&#115;&#x74;&#x2e;&#99;&#x6f;&#109;">&#108;&#107;&#x40;&#116;&#101;&#115;&#x74;&#x2e;&#99;&#x6f;&#109;</a>“</span>, <span style="color: #a5c25c">“<a href="mailto:&#109;&#107;&#x40;&#116;&#x65;&#115;&#x74;&#46;&#x63;&#x6f;&#109;">&#109;&#107;&#x40;&#116;&#x65;&#115;&#x74;&#46;&#x63;&#x6f;&#109;</a>“</span>);</p>
<p>            <span style="color: #cc7832">var</span> smtpClient &#x3D; mocks.Stub&lt;<span style="color: #6897bb">ISmtpClient</span><span style="font-weight: normal">&gt;();</span></p>
<p>            <span style="color: #cc7832">var</span> mailService &#x3D; <span style="color: #cc7832">new</span> <span style="color: #ffc66d">MailService</span>(smtpClient);</p>
<p>            mailService.EmailSent +&#x3D; ((sender, e) &#x3D;&gt; { emailSentRaised &#x3D; <span style="color: #cc7832">true</span>; });</p>
<p>            <span style="color: #cc7832">using</span> (mocks.Record())</p>
<p>            {</p>
<p>                <span style="color: #cc7832">var</span> raiser &#x3D; <span style="color: #ffc66d">Expect</span><span style="font-weight: normal">.Call(() &#x3D;&gt; smtpClient.SendCompleted +&#x3D; </span><span style="color: #cc7832">null</span>)</p>
<p>                                   .IgnoreArguments().GetEventRaiser();</p>
<p>                <span style="color: #ffc66d">Expect</span><span style="font-weight: normal">.Call(() &#x3D;&gt; smtpClient.SendAsync(message, </span><span style="color: #cc7832">null</span>))</p>
<p>                      .Do((<span style="color: #6897bb">Action</span><span style="font-weight: normal">&lt;</span><span style="color: #ffc66d">MailMessage</span>, <span style="color: #cc7832">object</span><span style="font-weight: normal">&gt;) ((arg1, arg2) &#x3D;&gt; raiser.Raise(message, </span><span style="color: #cc7832">null</span>)));</p>
<p>            }</p>
<p>            <span style="color: #cc7832">using</span> (mocks.Playback())</p>
<p>            {</p>
<p>                mailService.SendMailMessage(message);</p>
<p>                <span style="color: #ffc66d">Assert</span><span style="font-weight: normal">.That(emailSentRaised, </span><span style="color: #ffc66d">Is</span><span style="font-weight: normal">.EqualTo(</span><span style="color: #cc7832">true</span>));</p>
<p>            }</p>
<p>        }</p>
<p>    }</p>
<p>}<br> </div>  </p>
<p>I create a mock of the interface ISmtpClient. Then I inject this mock into my MailService class. I create a event handler for my MailService.EmailSent event using a lambda. This lambda, if called, will change the boolean value emailSentRaised from false to true. This exactly what I want to test in that unit test; that the EmailSent event is raised.</p>
<p>Then I get raiser object, a Rhino Mock <a target="_blank" rel="noopener" href="http://www.ayende.com/wiki/Rhino+Mocks+IEventRaiser.ashx">IEventRaiser</a>, from smtpClient.SendCompleted event.</p>
<p>Finally I set an expectation on smtpClient.SendAsync method adding a <a target="_blank" rel="noopener" href="http://www.ayende.com/wiki/Rhino+Mocks+The+Do()+Handler.ashx">Do() handler</a> that will raise the SendCompleted event.</p>
<p>Last point is using the mailService object, calling the SendMailMessage method and asserting that my boolean emailSentRaised went from false to true.</p>
<p>And here is the result in <a target="_blank" rel="noopener" href="http://www.jetbrains.com/resharper">ReSharper</a> Unit Test Session window. Green!</p>
<p><img src="http://farm4.static.flickr.com/3251/2540010420_6643d7e119_o.png"> </p>
<p><u><strong>Update</strong></u>: By the way, I forgot to add a link to a post from <a target="_blank" rel="noopener" href="http://haacked.com/articles/AboutHaacked.aspx">Phil Haack</a> “<a target="_blank" rel="noopener" href="http://haacked.com/archive/2006/06/23/usingrhinomockstounittesteventsoninterfaces.aspx">Using Rhino Mocks To Unit Test Events on Interfaces</a>“ and another link to a post from <a target="_blank" rel="noopener" href="http://codebetter.com/blogs/jean-paul_boodhoo/default.aspx">Jean-Paul S. Boodhoo</a> “<a target="_blank" rel="noopener" href="http://codebetter.com/blogs/jean-paul_boodhoo/archive/2007/05/07/raising-events-from-a-mock-using-rhino-mocks.aspx">Raising events (from a mock) using Rhino Mocks</a>“. To great post to read!</p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/mock/" rel="tag">mock</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/unit-test/" rel="tag">unit test</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2008/06/07/MSBuild-and-Silverlight-20-Beta-2-SDK-running-in-Team-City/"
                    data-tooltip="MSBuild and Silverlight 2.0 Beta 2 SDK running in Team City"
                    aria-label="PREVIOUS: MSBuild and Silverlight 2.0 Beta 2 SDK running in Team City"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2008/05/31/Two-Great-news-from-Silverlight-Streaming!/"
                    data-tooltip="Two Great news from Silverlight Streaming!"
                    aria-label="NEXT: Two Great news from Silverlight Streaming!"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/"
                    title="global.share_on_linkedin"
                    aria-label="global.share_on_linkedin"
                >
                    <i class="fab fa-linkedin" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2022 Laurent Kempé. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2008/06/07/MSBuild-and-Silverlight-20-Beta-2-SDK-running-in-Team-City/"
                    data-tooltip="MSBuild and Silverlight 2.0 Beta 2 SDK running in Team City"
                    aria-label="PREVIOUS: MSBuild and Silverlight 2.0 Beta 2 SDK running in Team City"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2008/05/31/Two-Great-news-from-Silverlight-Streaming!/"
                    data-tooltip="Two Great news from Silverlight Streaming!"
                    aria-label="NEXT: Two Great news from Silverlight Streaming!"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/"
                    title="global.share_on_linkedin"
                    aria-label="global.share_on_linkedin"
                >
                    <i class="fab fa-linkedin" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/"
                        aria-label="global.share_on_linkedin"
                    >
                        <i class="fab fa-linkedin" aria-hidden="true"></i><span>global.share_on_linkedin</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Laurent Kempé</h4>
        
            <div id="about-card-bio"><p>I am an experienced Team Leader &amp; Distinguished Solution Architect with a passion for shipping high-quality products by empowering development team and culture toward an agile mindset. I bring technical vision and strategy, leading engineering teams to move product, processes and architecture forward.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Team Leader, Distinguished Solutions Architect</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Illzach, France
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('https://farm5.staticflickr.com/4437/37116073235_dda239221d_o.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-l3xqy8bgzla5eyls4aaxacfnaumx77iyk3ulvydjw2z5xrvdwl22esltcxmd.min.js"></script>

<!--SCRIPTS END-->


    
        <script>
          var disqus_config = function() {
            this.page.url = 'https://laurentkempe.com/2008/06/01/Mocking-NET-framework-SmtpClient-class/';
              
            this.page.identifier = '20080601074120';
              
          };
          (function() {
            var d = document, s = d.createElement('script');
            var disqus_shortname = 'laurentkempe';
            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
    




    </body>
</html>
