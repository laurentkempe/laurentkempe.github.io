
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Laurent Kemp√©">
    <title>Leveraging Microsoft.Extensions.AI for Tool Calling in C# - Laurent Kemp√©</title>
    <meta name="author" content="Laurent Kemp√©">
    
    
        <link rel="icon" href="https://laurentkempe.com/assets/images/favicon.ico">
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Laurent Kemp√©","sameAs":["https://github.com/laurentkempe","https://bsky.app/profile/laurentkempe.com","https://twitter.com/laurentkempe","https://www.linkedin.com/in/laurentkempe","https://flickr.com/photos/laurentkempe/"],"image":"https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg"},"articleBody":"In the previous post ‚ÄúLearning AI function calling in C# with Llama 3.2 SLM and Ollama running on your machine‚Äú, we wrapped our head around the concept of tool calling and implemented a C# source generator enabling our functions to be called by Llama 3.2 SLM using Ollama. \nIn this post, we will explore how to use Microsoft Extensions AI for tool calling in a simple .NET CLI application. We will leverage the power of Ollama and Llama 3.2 SLM to call functions and interact with the AI model using C#.\n\nIntroductionTool calling in AI, often referred to as function calling, is a feature that allows AI models, particularly Language Models (LMs), to perform tasks beyond simple text generation by invoking predefined functions. This capability significantly enhances the interaction between humans and AI applications, allowing for more complex and structured outputs.\nIn essence, tool calling enables an AI model to use external tools, such as APIs and functions, to respond to prompts with more than just text. For example, an AI could be prompted to retrieve the weather forecast for a specific location. Instead of generating a text-based guess, the model can invoke a function that interacts with a weather API to provide accurate, real-time data.\nThe process involves two main components: the function name and a structured set of arguments, usually defined using JSONSchema. These arguments are essential for executing the specified function. The beauty of tool calling lies in its simplicity and efficiency. It offloads the responsibility of parsing structured output to the model providers, such as OpenAI, allowing for more accurate and reliable responses.\nTool calling is particularly useful for creating modular and scalable AI systems. It provides a way to structure outputs consistently, simplifies the interaction by embedding the concept directly into the model, and offers a secure method to prevent users from manipulating the model‚Äôs output in unintended ways.\nRequirements\nLlama 3.2 SLM, a model supporting function calling\nOllama to run the SLM and deal with the integration\nA .NET CLI application using Microsoft.Extensions.AI\n\nSetting Up Your EnvironmentTo get started with AI function calling in C#, you need to\n\nInstall Ollama to run the SLM and handle the integration\nPull Llama 3.2 SLM model on your machine ollama pull llama3.2:3b\n\nCreating a .NET CLI ApplicationWe create a simple .NET CLI application that interacts with the AI model using Microsoft.Extensions.AI. This library provides a unified set of AI building blocks for .NET applications, making it easy to integrate AI capabilities into your projects.\n123dotnet new console -n OllamaToolCallingMicrosoftExtensionscd OllamaToolCallingMicrosoftExtensionsdotnet add package Microsoft.Extensions.AI\n\nImplementing Tool Calling using Microsoft.Extensions.AIThis is how simple it is to implement tool calling using Microsoft.Extensions.AI in a .NET CLI application. We define two functions, GetCurrentTime and GetCurrentWeather, and use them as tools in the chat client. The chat client is configured to use Ollama as the chat client and wraps the function invocation client with logging.\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748using System.ComponentModel;using Microsoft.Extensions.AI;using Microsoft.Extensions.Logging;Console.WriteLine(&quot;Hello, Microsoft.Extensions.AI with Ollama &amp; Tool calling!&quot;);var message = &quot;What time is it in Illzach, France?&quot;;Console.WriteLine(message);using var factory = LoggerFactory.Create(builder =&gt;     builder.AddConsole().SetMinimumLevel(LogLevel.Trace));// üëáüèº Use Ollama as the chat clientvar ollamaChatClient =     new OllamaChatClient(new Uri(&quot;http://localhost:11434/&quot;), &quot;llama3.2:3b&quot;);var client = new ChatClientBuilder(ollamaChatClient)    // üëáüèº Add logging to the chat client, wrapping the function invocation client     .UseLogging(factory)    // üëáüèº Add function invocation to the chat client, wrapping the Ollama client    .UseFunctionInvocation()    .Build();var chatOptions = new ChatOptions&#123;    // üëáüèº Define tools that can be used by the chat client    Tools =    [        AIFunctionFactory.Create(GetCurrentTime),        AIFunctionFactory.Create(GetCurrentWeather)    ]&#125;;var response = await client.CompleteAsync(message, chatOptions);Console.Write(response);// üëáüèº Define a time tool[Description(&quot;Get the current time for a city&quot;)]string GetCurrentTime(string city)&#123;    return $&quot;It is &#123;DateTime.Now.Hour&#125;:&#123;DateTime.Now.Minute&#125; in &#123;city&#125;.&quot;;&#125;// üëáüèº Define a weather tool[Description(&quot;Get the current weather for a city&quot;)]string GetCurrentWeather(string city)&#123;    return $&quot;The weather in &#123;city&#125; is sunny.&quot;;&#125;\n\nResultRunning the code will output the following:\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253 ‚ùØ  dotnet runHello, Microsoft.Extensions.AI with Ollama &amp; Tool calling!What time is it in Illzach, France?trce: Microsoft.Extensions.AI.LoggingChatClient[805843669]      CompleteAsync invoked: [        &#123;          &quot;role&quot;: &quot;user&quot;,          &quot;contents&quot;: [            &#123;              &quot;$type&quot;: &quot;text&quot;,              &quot;text&quot;: &quot;What time is it in Illzach, France?&quot;            &#125;          ]        &#125;      ]. Options: &#123;        &quot;toolMode&quot;: &#123;          &quot;$type&quot;: &quot;auto&quot;        &#125;      &#125;. Metadata: &#123;        &quot;providerName&quot;: &quot;ollama&quot;,        &quot;providerUri&quot;: &quot;http://localhost:11434/&quot;,        &quot;modelId&quot;: &quot;llama3.2:3b&quot;      &#125;.trce: Microsoft.Extensions.AI.LoggingChatClient[384896670]      CompleteAsync completed: &#123;        &quot;choices&quot;: [          &#123;            &quot;role&quot;: &quot;assistant&quot;,            &quot;contents&quot;: [              &#123;                &quot;$type&quot;: &quot;text&quot;,                &quot;text&quot;: &quot;The current time in Illzach, France is 10:45.&quot;              &#125;            ]          &#125;        ],        &quot;completionId&quot;: &quot;2025-01-26T09:45:18.8271931Z&quot;,        &quot;modelId&quot;: &quot;llama3.2:3b&quot;,        &quot;createdAt&quot;: &quot;2025-01-26T09:45:18.8271931+00:00&quot;,        &quot;finishReason&quot;: &quot;stop&quot;,        &quot;usage&quot;: &#123;          &quot;inputTokenCount&quot;: 368,          &quot;outputTokenCount&quot;: 45,          &quot;totalTokenCount&quot;: 413,          &quot;additionalCounts&quot;: &#123;            &quot;load_duration&quot;: 42408700,            &quot;total_duration&quot;: 805363100,            &quot;prompt_eval_duration&quot;: 108000000,            &quot;eval_duration&quot;: 652000000          &#125;        &#125;      &#125;.The current time in Illzach, France is 10:45.\n\nAs we added the logging with trace level, we can see the trace of chat client‚Äôs interactions with Ollama. The chat client sends the message ‚ÄúWhat time is it in Illzach, France?‚Äù to Ollama, which invokes the GetCurrentTime function and returns the current time in Illzach, France. The logging also provides additional information about the completion like token usage. I think it could be useful to see the function invocation in the trace.\nConclusionWe explored how to leverage Microsoft.Extensions.AI for tool calling in a .NET CLI application using Ollama and Llama 3.2 SLM. We demonstrated the setup process, created a simple application, and implemented tool calling to interact with AI models. By integrating these technologies, developers can enhance their applications with advanced AI capabilities, enabling more complex and structured interactions. This approach provides a robust framework for building modular AI systems.\nReferences\nIntroducing Microsoft.Extensions.AI Preview ‚Äì Unified AI Building Blocks for .NET\nUnified AI building blocks for .NET using Microsoft.Extensions.AI\nMicrosoft.Extensions.AI nuget\nOllama Tool support\nLlama 3.2 SLM\n\nGet the source code on GitHub laurentkempe&#x2F;aiPlayground&#x2F;OllamaToolCallingMicrosoftExtensions.\n\n\n  \n\n\n\n\n","dateCreated":"2025-01-27T12:32:02+00:00","dateModified":"2025-02-01T14:41:42+00:00","datePublished":"2025-01-27T12:32:02+00:00","description":"In the previous post ‚ÄúLearning AI function calling in C# with Llama 3.2 SLM and Ollama running on your machine‚Äú, we wrapped our head around the concept of tool calling and implemented a C# source generator enabling our functions to be called by Llama 3.2 SLM using Ollama. \nIn this post, we will explore how to use Microsoft Extensions AI for tool calling in a simple .NET CLI application. We will leverage the power of Ollama and Llama 3.2 SLM to call functions and interact with the AI model using C#.","headline":"Leveraging Microsoft.Extensions.AI for Tool Calling in C#","image":["https://live.staticflickr.com/65535/54288342071_75a4049e30_q.jpg","https://live.staticflickr.com/65535/54288342071_35f9e28bf5_h.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://laurentkempe.com/2025/01/27/leveraging-microsoftextensionsai-for-tool-calling-in-csharp/"},"publisher":{"@type":"Organization","name":"Laurent Kemp√©","sameAs":["https://github.com/laurentkempe","https://bsky.app/profile/laurentkempe.com","https://twitter.com/laurentkempe","https://www.linkedin.com/in/laurentkempe","https://flickr.com/photos/laurentkempe/"],"image":"https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg","logo":{"@type":"ImageObject","url":"https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg"}},"url":"https://laurentkempe.com/2025/01/27/leveraging-microsoftextensionsai-for-tool-calling-in-csharp/","keywords":"C#, AI, LLM, Ollama, SLM","thumbnailUrl":"https://live.staticflickr.com/65535/54288342071_75a4049e30_q.jpg"}</script>
    <meta name="description" content="In the previous post ‚ÄúLearning AI function calling in C# with Llama 3.2 SLM and Ollama running on your machine‚Äú, we wrapped our head around the concept of tool calling and implemented a C# source gene">
<meta property="og:type" content="blog">
<meta property="og:title" content="Leveraging Microsoft.Extensions.AI for Tool Calling in C#">
<meta property="og:url" content="https://laurentkempe.com/2025/01/27/leveraging-microsoftextensionsai-for-tool-calling-in-csharp/index.html">
<meta property="og:site_name" content="Laurent Kemp√©">
<meta property="og:description" content="In the previous post ‚ÄúLearning AI function calling in C# with Llama 3.2 SLM and Ollama running on your machine‚Äú, we wrapped our head around the concept of tool calling and implemented a C# source gene">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-01-27T12:32:02.000Z">
<meta property="article:modified_time" content="2025-02-01T14:41:42.578Z">
<meta property="article:author" content="Laurent Kemp√©">
<meta property="article:tag" content="C#">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="LLM">
<meta property="article:tag" content="Ollama">
<meta property="article:tag" content="SLM">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@laurentkempe">
    
    
        
    
    
        <meta property="og:image" content="https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg"/>
    
    
        <meta property="og:image" content="https://live.staticflickr.com/65535/54288342071_75a4049e30_q.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://live.staticflickr.com/65535/54288342071_75a4049e30_q.jpg"/>
    
    
        <meta property="og:image" content="https://live.staticflickr.com/65535/54288342071_35f9e28bf5_h.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://live.staticflickr.com/65535/54288342071_35f9e28bf5_h.jpg"/>
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-47xau4ztel5svwy5hp9am4isoo2erfbofrzsmxerejzryslmkqkdvnb73s7u.min.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Laurent Kemp√©
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Laurent Kemp√©</h4>
                
                    <h5 class="sidebar-profile-bio"><p>I am an experienced Team Leader &amp; Distinguished Solution Architect with a passion for shipping high-quality products by empowering development team and culture toward an agile mindset. I bring technical vision and strategy, leading engineering teams to move product, processes and architecture forward.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/presentations.html"
                            
                            rel="noopener"
                            title="Presentations"
                        >
                        <i class="sidebar-button-icon fa fa-file-powerpoint" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Presentations</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/about-laurent-kempe.html"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/laurentkempe"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://bsky.app/profile/laurentkempe.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Bluesky"
                        >
                        <i class="sidebar-button-icon fab fa-bluesky" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Bluesky</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://twitter.com/laurentkempe"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Twitter"
                        >
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/laurentkempe"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://flickr.com/photos/laurentkempe/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Flickr"
                        >
                        <i class="sidebar-button-icon fab fa-flickr" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Flickr</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="http://feeds.feedburner.com/laurentkempe"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
        <div class="post-header-cover
                    text-left
                    post-header-cover--partial"
             style="background-image:url('https://live.staticflickr.com/65535/54288342071_35f9e28bf5_h.jpg');"
             data-behavior="5">
            
                <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            Leveraging Microsoft.Extensions.AI for Tool Calling in C#
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2025-01-27T12:32:02+00:00">
	
		    Jan 27, 2025
    	
    </time>
    
</div>

    
</div>

            
        </div>

            <div id="main" data-behavior="5"
                 class="hasCover
                        hasCoverMetaIn
                        hasCoverCaption">
                
<article class="post">
    
        <span class="post-header-cover-caption caption">Liebvillers, France</span>
    
    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>In the previous post ‚Äú<a href="https://laurentkempe.com/2024/10/28/learning-ai-function-calling-in-csharp-with-llama-32-slm-and-ollama-running-on-your-machine/">Learning AI function calling in C# with Llama 3.2 SLM and Ollama running on your machine</a>‚Äú, we wrapped our head around the concept of tool calling and implemented a C# source generator enabling our functions to be called by Llama 3.2 SLM using Ollama. </p>
<p>In this post, we will explore how to use Microsoft Extensions AI for tool calling in a simple .NET CLI application. We will leverage the power of Ollama and Llama 3.2 SLM to call functions and interact with the AI model using C#.</p>
<span id="more"></span>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Tool calling in AI, often referred to as function calling, is a feature that allows AI models, particularly Language Models (LMs), to perform tasks beyond simple text generation by invoking predefined functions. This capability significantly enhances the interaction between humans and AI applications, allowing for more complex and structured outputs.</p>
<p>In essence, tool calling enables an AI model to use external tools, such as APIs and functions, to respond to prompts with more than just text. For example, an AI could be prompted to retrieve the weather forecast for a specific location. Instead of generating a text-based guess, the model can invoke a function that interacts with a weather API to provide accurate, real-time data.</p>
<p>The process involves two main components: the function name and a structured set of arguments, usually defined using JSONSchema. These arguments are essential for executing the specified function. The beauty of tool calling lies in its simplicity and efficiency. It offloads the responsibility of parsing structured output to the model providers, such as OpenAI, allowing for more accurate and reliable responses.</p>
<p>Tool calling is particularly useful for creating modular and scalable AI systems. It provides a way to structure outputs consistently, simplifies the interaction by embedding the concept directly into the model, and offers a secure method to prevent users from manipulating the model‚Äôs output in unintended ways.</p>
<h1 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h1><ul>
<li><strong>Llama 3.2 SLM</strong>, a model supporting function calling</li>
<li><strong>Ollama</strong> to run the SLM and deal with the integration</li>
<li>A .NET CLI application using Microsoft.Extensions.AI</li>
</ul>
<h1 id="Setting-Up-Your-Environment"><a href="#Setting-Up-Your-Environment" class="headerlink" title="Setting Up Your Environment"></a>Setting Up Your Environment</h1><p>To get started with AI function calling in C#, you need to</p>
<ul>
<li>Install <a target="_blank" rel="noopener" href="https://www.ollama.com/">Ollama</a> to run the SLM and handle the integration</li>
<li>Pull Llama 3.2 SLM model on your machine <code>ollama pull llama3.2:3b</code></li>
</ul>
<h1 id="Creating-a-NET-CLI-Application"><a href="#Creating-a-NET-CLI-Application" class="headerlink" title="Creating a .NET CLI Application"></a>Creating a .NET CLI Application</h1><p>We create a simple .NET CLI application that interacts with the AI model using <code>Microsoft.Extensions.AI</code>. This library provides a unified set of AI building blocks for .NET applications, making it easy to integrate AI capabilities into your projects.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dotnet new console <span class="literal">-n</span> OllamaToolCallingMicrosoftExtensions</span><br><span class="line"><span class="built_in">cd</span> OllamaToolCallingMicrosoftExtensions</span><br><span class="line">dotnet add package Microsoft.Extensions.AI</span><br></pre></td></tr></table></figure>

<h1 id="Implementing-Tool-Calling-using-Microsoft-Extensions-AI"><a href="#Implementing-Tool-Calling-using-Microsoft-Extensions-AI" class="headerlink" title="Implementing Tool Calling using Microsoft.Extensions.AI"></a>Implementing Tool Calling using Microsoft.Extensions.AI</h1><p>This is how simple it is to implement tool calling using <code>Microsoft.Extensions.AI</code> in a .NET CLI application. We define two functions, <code>GetCurrentTime</code> and <code>GetCurrentWeather</code>, and use them as tools in the chat client. The chat client is configured to use Ollama as the chat client and wraps the function invocation client with logging.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.ComponentModel;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.AI;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Logging;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot;Hello, Microsoft.Extensions.AI with Ollama &amp; Tool calling!&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> message = <span class="string">&quot;What time is it in Illzach, France?&quot;</span>;</span><br><span class="line">Console.WriteLine(message);</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> factory = LoggerFactory.Create(builder =&gt; </span><br><span class="line">    builder.AddConsole().SetMinimumLevel(LogLevel.Trace));</span><br><span class="line"></span><br><span class="line"><span class="comment">// üëáüèº Use Ollama as the chat client</span></span><br><span class="line"><span class="keyword">var</span> ollamaChatClient = </span><br><span class="line">    <span class="keyword">new</span> OllamaChatClient(<span class="keyword">new</span> Uri(<span class="string">&quot;http://localhost:11434/&quot;</span>), <span class="string">&quot;llama3.2:3b&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> client = <span class="keyword">new</span> ChatClientBuilder(ollamaChatClient)</span><br><span class="line">    <span class="comment">// üëáüèº Add logging to the chat client, wrapping the function invocation client </span></span><br><span class="line">    .UseLogging(factory)</span><br><span class="line">    <span class="comment">// üëáüèº Add function invocation to the chat client, wrapping the Ollama client</span></span><br><span class="line">    .UseFunctionInvocation()</span><br><span class="line">    .Build();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> chatOptions = <span class="keyword">new</span> ChatOptions</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// üëáüèº Define tools that can be used by the chat client</span></span><br><span class="line">    Tools =</span><br><span class="line">    [</span><br><span class="line">        AIFunctionFactory.Create(GetCurrentTime),</span><br><span class="line">        AIFunctionFactory.Create(GetCurrentWeather)</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> response = <span class="keyword">await</span> client.CompleteAsync(message, chatOptions);</span><br><span class="line"></span><br><span class="line">Console.Write(response);</span><br><span class="line"></span><br><span class="line"><span class="comment">// üëáüèº Define a time tool</span></span><br><span class="line">[<span class="meta">Description(<span class="string">&quot;Get the current time for a city&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">GetCurrentTime</span>(<span class="params"><span class="built_in">string</span> city</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">$&quot;It is <span class="subst">&#123;DateTime.Now.Hour&#125;</span>:<span class="subst">&#123;DateTime.Now.Minute&#125;</span> in <span class="subst">&#123;city&#125;</span>.&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// üëáüèº Define a weather tool</span></span><br><span class="line">[<span class="meta">Description(<span class="string">&quot;Get the current weather for a city&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">GetCurrentWeather</span>(<span class="params"><span class="built_in">string</span> city</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">$&quot;The weather in <span class="subst">&#123;city&#125;</span> is sunny.&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h1><p>Running the code will output the following:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"> ‚ùØ  dotnet run</span><br><span class="line">Hello, Microsoft.Extensions.AI with Ollama &amp; Tool calling!</span><br><span class="line">What time is it <span class="keyword">in</span> Illzach, France?</span><br><span class="line">trce: Microsoft.Extensions.AI.LoggingChatClient[<span class="number">805843669</span>]</span><br><span class="line">      CompleteAsync invoked: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">          <span class="string">&quot;contents&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="string">&quot;<span class="variable">$type</span>&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">              <span class="string">&quot;text&quot;</span>: <span class="string">&quot;What time is it in Illzach, France?&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]. Options: &#123;</span><br><span class="line">        <span class="string">&quot;toolMode&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;<span class="variable">$type</span>&quot;</span>: <span class="string">&quot;auto&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;. Metadata: &#123;</span><br><span class="line">        <span class="string">&quot;providerName&quot;</span>: <span class="string">&quot;ollama&quot;</span>,</span><br><span class="line">        <span class="string">&quot;providerUri&quot;</span>: <span class="string">&quot;http://localhost:11434/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;modelId&quot;</span>: <span class="string">&quot;llama3.2:3b&quot;</span></span><br><span class="line">      &#125;.</span><br><span class="line">trce: Microsoft.Extensions.AI.LoggingChatClient[<span class="number">384896670</span>]</span><br><span class="line">      CompleteAsync completed: &#123;</span><br><span class="line">        <span class="string">&quot;choices&quot;</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>,</span><br><span class="line">            <span class="string">&quot;contents&quot;</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="string">&quot;<span class="variable">$type</span>&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                <span class="string">&quot;text&quot;</span>: <span class="string">&quot;The current time in Illzach, France is 10:45.&quot;</span></span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&quot;completionId&quot;</span>: <span class="string">&quot;2025-01-26T09:45:18.8271931Z&quot;</span>,</span><br><span class="line">        <span class="string">&quot;modelId&quot;</span>: <span class="string">&quot;llama3.2:3b&quot;</span>,</span><br><span class="line">        <span class="string">&quot;createdAt&quot;</span>: <span class="string">&quot;2025-01-26T09:45:18.8271931+00:00&quot;</span>,</span><br><span class="line">        <span class="string">&quot;finishReason&quot;</span>: <span class="string">&quot;stop&quot;</span>,</span><br><span class="line">        <span class="string">&quot;usage&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;inputTokenCount&quot;</span>: <span class="number">368</span>,</span><br><span class="line">          <span class="string">&quot;outputTokenCount&quot;</span>: <span class="number">45</span>,</span><br><span class="line">          <span class="string">&quot;totalTokenCount&quot;</span>: <span class="number">413</span>,</span><br><span class="line">          <span class="string">&quot;additionalCounts&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;load_duration&quot;</span>: <span class="number">42408700</span>,</span><br><span class="line">            <span class="string">&quot;total_duration&quot;</span>: <span class="number">805363100</span>,</span><br><span class="line">            <span class="string">&quot;prompt_eval_duration&quot;</span>: <span class="number">108000000</span>,</span><br><span class="line">            <span class="string">&quot;eval_duration&quot;</span>: <span class="number">652000000</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;.</span><br><span class="line">The current time <span class="keyword">in</span> Illzach, France is <span class="number">10</span>:<span class="number">45</span>.</span><br></pre></td></tr></table></figure>

<p>As we added the logging with trace level, we can see the trace of chat client‚Äôs interactions with Ollama. The chat client sends the message ‚ÄúWhat time is it in Illzach, France?‚Äù to Ollama, which invokes the <code>GetCurrentTime</code> function and returns the current time in Illzach, France. The logging also provides additional information about the completion like token usage. I think it could be useful to see the function invocation in the trace.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>We explored how to leverage <code>Microsoft.Extensions.AI</code> for tool calling in a .NET CLI application using Ollama and Llama 3.2 SLM. We demonstrated the setup process, created a simple application, and implemented tool calling to interact with AI models. By integrating these technologies, developers can enhance their applications with advanced AI capabilities, enabling more complex and structured interactions. This approach provides a robust framework for building modular AI systems.</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul>
<li><a target="_blank" rel="noopener" href="https://devblogs.microsoft.com/dotnet/introducing-microsoft-extensions-ai-preview/">Introducing Microsoft.Extensions.AI Preview ‚Äì Unified AI Building Blocks for .NET</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/dotnet/ai/ai-extensions">Unified AI building blocks for .NET using Microsoft.Extensions.AI</a></li>
<li><a target="_blank" rel="noopener" href="https://www.nuget.org/packages/Microsoft.Extensions.AI/9.0.1-preview.1.24570.5#readme-body-tab">Microsoft.Extensions.AI nuget</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ollama.com/blog/tool-support">Ollama Tool support</a></li>
<li><a target="_blank" rel="noopener" href="https://ollama.com/">Llama 3.2 SLM</a></li>
</ul>
<p>Get the source code on GitHub <a target="_blank" rel="noopener" href="https://github.com/laurentkempe/aiPlayground/tree/main/OllamaToolCallingMicrosoftExtensions">laurentkempe&#x2F;aiPlayground&#x2F;OllamaToolCallingMicrosoftExtensions</a>.</p>
<p></p>
<div style="text-align: left">
  <div class="github-card"
    data-user="laurentkempe"
    data-repo="aiPlayground"
    data-height="200"
    data-width="400"
    data-theme="default"
    data-target=""
    data-client-id=""
    data-client-secret=""
  ></div>
</div>
<script src="/github-card-lib/githubcard.js"></script>



            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/AI/" rel="tag">AI</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/C/" rel="tag">C#</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/LLM/" rel="tag">LLM</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Ollama/" rel="tag">Ollama</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/SLM/" rel="tag">SLM</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2025/02/01/harnessing-deepseek-r1-with-dotnet-aspire-and-ollama-locally/"
                    data-tooltip="Harnessing DeepSeek-R1 distilled model with .NET Aspire and Ollama locally"
                    aria-label="PREVIOUS: Harnessing DeepSeek-R1 distilled model with .NET Aspire and Ollama locally"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2024/10/28/learning-ai-function-calling-in-csharp-with-llama-32-slm-and-ollama-running-on-your-machine/"
                    data-tooltip="Learning AI function calling in C# with Llama 3.2 SLM and Ollama running on your machine"
                    aria-label="NEXT: Learning AI function calling in C# with Llama 3.2 SLM and Ollama running on your machine"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://laurentkempe.com/2025/01/27/leveraging-microsoftextensionsai-for-tool-calling-in-csharp/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://laurentkempe.com/2025/01/27/leveraging-microsoftextensionsai-for-tool-calling-in-csharp/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://laurentkempe.com/2025/01/27/leveraging-microsoftextensionsai-for-tool-calling-in-csharp/"
                    title="global.share_on_linkedin"
                    aria-label="global.share_on_linkedin"
                >
                    <i class="fab fa-linkedin" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Laurent Kemp√©. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2025/02/01/harnessing-deepseek-r1-with-dotnet-aspire-and-ollama-locally/"
                    data-tooltip="Harnessing DeepSeek-R1 distilled model with .NET Aspire and Ollama locally"
                    aria-label="PREVIOUS: Harnessing DeepSeek-R1 distilled model with .NET Aspire and Ollama locally"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2024/10/28/learning-ai-function-calling-in-csharp-with-llama-32-slm-and-ollama-running-on-your-machine/"
                    data-tooltip="Learning AI function calling in C# with Llama 3.2 SLM and Ollama running on your machine"
                    aria-label="NEXT: Learning AI function calling in C# with Llama 3.2 SLM and Ollama running on your machine"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://laurentkempe.com/2025/01/27/leveraging-microsoftextensionsai-for-tool-calling-in-csharp/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://laurentkempe.com/2025/01/27/leveraging-microsoftextensionsai-for-tool-calling-in-csharp/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://laurentkempe.com/2025/01/27/leveraging-microsoftextensionsai-for-tool-calling-in-csharp/"
                    title="global.share_on_linkedin"
                    aria-label="global.share_on_linkedin"
                >
                    <i class="fab fa-linkedin" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://laurentkempe.com/2025/01/27/leveraging-microsoftextensionsai-for-tool-calling-in-csharp/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://laurentkempe.com/2025/01/27/leveraging-microsoftextensionsai-for-tool-calling-in-csharp/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://laurentkempe.com/2025/01/27/leveraging-microsoftextensionsai-for-tool-calling-in-csharp/"
                        aria-label="global.share_on_linkedin"
                    >
                        <i class="fab fa-linkedin" aria-hidden="true"></i><span>global.share_on_linkedin</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Laurent Kemp√©</h4>
        
            <div id="about-card-bio"><p>I am an experienced Team Leader &amp; Distinguished Solution Architect with a passion for shipping high-quality products by empowering development team and culture toward an agile mindset. I bring technical vision and strategy, leading engineering teams to move product, processes and architecture forward.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Team Leader, Distinguished Solutions Architect</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Illzach, France
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('https://farm5.staticflickr.com/4437/37116073235_dda239221d_o.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-oqkmg7me2c11hio8iwpyadtuzaub7wspjhgptqfw2xzg5fkst0s8m9dp2xz5.min.js"></script>

<!--SCRIPTS END-->



    




    </body>
</html>
