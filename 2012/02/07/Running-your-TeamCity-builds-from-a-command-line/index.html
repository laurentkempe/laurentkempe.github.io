
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Laurent Kempé">
    <title>Running your TeamCity builds from PowerShell for any Git branch - Laurent Kempé</title>
    <meta name="author" content="Laurent Kempé">
    
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Laurent Kempé","sameAs":["https://github.com/laurentkempe","https://twitter.com/laurentkempe","https://www.linkedin.com/in/laurentkempe","https://flickr.com/photos/laurentkempe/"],"image":"https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg"},"articleBody":"  \n\nI love TeamCity and use it since a while to automate my build/release processes. As human we should never do the work a machine can do, we have certainly better and more interesting things to do.\n\n\nThe habit I saw in the different projects I worked for is to create new TeamCity builds for the branches you work on. It take quite some work to do, even with templates…\nSo I came with another way of doing it. It is leverage Git, PowerShell and the possibility to run TeamCity builds by “Accessing Server by HTTP”. Basically you just need to make a HTTP request to an Url like this:\n\nhttp:``//testuser:testpassword@teamcity.jetbrains.com/httpAuth/action.html?add2Queue=bt10&amp;system.name=&lt;property name1&gt;&amp;system.value=&lt;value1&gt;&amp;system.name=&lt;property name2&gt;&amp;system.value=&lt;value2&gt;&amp;env.name=&lt;environment variable name1&gt;&amp;env.value=&lt;environment variable value1&gt;&amp;env.name=&lt;environment variable name2&gt;&amp;env.value=&lt;environment variable value2&gt;\n\nWe will also use the possibility to pass custom parameters (system properties and environment variables) through the HTTP request.\nThe parameter we want to pass is the Ref name of the Git VCS Root, so we start by setting it using a configuration parameter called BuildRefName, as this:\n    \nThen we need to add a configuration parameters for our TeamCity project with the name BuildRefName which we currently set to master, so that if the parameter is not defined it will default to this value:    \nNow that we have configured this you can already start a build from your browser by calling the URL!\n\nhttp:``//testuser:testpassword@teamcity.jetbrains.com/httpAuth/action.html?add2Queue=bt10\n\nBe sure to replace bt10 with your build id.\nNice ,but we want to get a step further and be able to start the build from PowerShell, which is quite easy!\nTo achieve this goal you add those two functions to your PowerShell profile:\nMicrosoft.PowerShell_profile.ps1123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960function Get-Web($url,     [switch]$self,    $credential,     $toFile,    [switch]$bytes)&#123;    #.Synopsis    #    Downloads a file from the web    #.Description    #    Uses System.Net.Webclient (not the browser) to download data    #    from the web.    #.Parameter self    #    Uses the default credentials when downloading that page (for downloading intranet pages)    #.Parameter credential    #    The credentials to use to download the web data    #.Parameter url    #    The page to download (e.g. www.msn.com)        #.Parameter toFile    #    The file to save the web data to    #.Parameter bytes    #    Download the data as bytes       #.Example    #    # Downloads www.live.com and outputs it as a string    #    Get-Web http://www.live.com/    #.Example    #    # Downloads www.live.com and saves it to a file    #    Get-Web http://wwww.msn.com/ -toFile www.msn.com.html    $webclient = New-Object Net.Webclient    if ($credential) &#123;        $webClient.Credentials = $credential    &#125;    if ($self) &#123;        $webClient.UseDefaultCredentials = $true    &#125;    if ($toFile) &#123;        if (-not &quot;$toFile&quot;.Contains(&quot;:&quot;)) &#123;            $toFile = Join-Path $pwd $toFile        &#125;        $webClient.DownloadFile($url, $toFile)    &#125; else &#123;        if ($bytes) &#123;            $webClient.DownloadData($url)        &#125; else &#123;            $webClient.DownloadString($url)        &#125;    &#125;&#125;function tcBuild([string]$branch) &#123;    $url = &quot;http://YourServerUrl/httpAuth/action.html?add2Queue=YourBuildId&quot;    if ($branch) &#123;        $url = $url + &quot;&amp;name=BuildRefName&amp;value=&quot; + $branch    &#125;        $credentials = New-Object System.Net.NetworkCredential(&quot;Username&quot;, &quot;Password&quot;)    Get-Web $url -credential $credentials&#125;\n\nPlease adapt the tcBuild script by replacing the YourServerUrl, YourBuildId, Username, Password by your personal values.\nThe first function Get-Web is from this blog post: “Microcode: PowerShell Scripting Tricks: Scripting The Web (Part 1) (Get-Web)”.\nThe second, tcBuild, is quite easy and is the one you will use to start a build on the TeamCity server.\nMy workflow now is the following one:\n\nI commit on my local Git repository then \nwhen I want to run a build I push to the centralized Git origin repository in my branch then \nI start my build on the Git Branch from PowerShell by typing : \n\n\ntcBuild Jobping-10-NewFeature\n\nwhere Jobping-10-NewFeature is the name of my Git branch.\nThis is quite cool and give me also the possibility to run kind of personal builds!\n","dateCreated":"2012-02-07T00:09:02+00:00","dateModified":"2012-02-08T15:50:22+00:00","datePublished":"2012-02-07T00:09:02+00:00","description":"  \n\nI love TeamCity and use it since a while to automate my build/release processes. As human we should never do the work a machine can do, we have certainly better and more interesting things to do.","headline":"Running your TeamCity builds from PowerShell for any Git branch","image":["https://farm6.staticflickr.com/5257/5561493976_859ff775f3_q.jpg","https://farm6.staticflickr.com/5257/5561493976_859ff775f3_b.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/"},"publisher":{"@type":"Organization","name":"Laurent Kempé","sameAs":["https://github.com/laurentkempe","https://twitter.com/laurentkempe","https://www.linkedin.com/in/laurentkempe","https://flickr.com/photos/laurentkempe/"],"image":"https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg","logo":{"@type":"ImageObject","url":"https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg"}},"url":"https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/","keywords":"Git, Agile, PowerShell, Productivity, Team City","thumbnailUrl":"https://farm6.staticflickr.com/5257/5561493976_859ff775f3_q.jpg"}</script>
    <meta name="description" content="I love TeamCity and use it since a while to automate my build&#x2F;release processes. As human we should never do the work a machine can do, we have certainly better and more interesting things to do.">
<meta property="og:type" content="blog">
<meta property="og:title" content="Running your TeamCity builds from PowerShell for any Git branch">
<meta property="og:url" content="https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/index.html">
<meta property="og:site_name" content="Laurent Kempé">
<meta property="og:description" content="I love TeamCity and use it since a while to automate my build&#x2F;release processes. As human we should never do the work a machine can do, we have certainly better and more interesting things to do.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://farm8.staticflickr.com/7005/6830300407_f835d6002f_o.png">
<meta property="og:image" content="http://farm8.staticflickr.com/7164/6830361585_d10f7c0f3a_o.png">
<meta property="article:published_time" content="2012-02-07T00:09:02.000Z">
<meta property="article:modified_time" content="2012-02-08T15:50:22.000Z">
<meta property="article:author" content="Laurent Kempé">
<meta property="article:tag" content="Git">
<meta property="article:tag" content="Agile">
<meta property="article:tag" content="PowerShell">
<meta property="article:tag" content="Productivity">
<meta property="article:tag" content="Team City">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://farm8.staticflickr.com/7005/6830300407_f835d6002f_o.png">
<meta name="twitter:creator" content="@laurentkempe">
    
    
        
    
    
        <meta property="og:image" content="https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg"/>
    
    
        <meta property="og:image" content="https://farm6.staticflickr.com/5257/5561493976_859ff775f3_q.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://farm6.staticflickr.com/5257/5561493976_859ff775f3_q.jpg"/>
    
    
        <meta property="og:image" content="https://farm6.staticflickr.com/5257/5561493976_859ff775f3_b.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://farm6.staticflickr.com/5257/5561493976_859ff775f3_b.jpg"/>
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-ttekjebznc4bdplu6ojwhlgsmkg7rqzvcgsbvc5jjrk7ojk12buynffv5hyz.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-64298-8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-64298-8');
    </script>


    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Laurent Kempé
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Laurent Kempé</h4>
                
                    <h5 class="sidebar-profile-bio"><p>I am an experienced Team Leader &amp; Distinguished Solution Architect with a passion for shipping high-quality products by empowering development team and culture toward an agile mindset. I bring technical vision and strategy, leading engineering teams to move product, processes and architecture forward.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/presentations.html"
                            
                            rel="noopener"
                            title="Presentations"
                        >
                        <i class="sidebar-button-icon fa fa-file-powerpoint" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Presentations</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/about-laurent-kempe.html"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/laurentkempe"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://twitter.com/laurentkempe"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Twitter"
                        >
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/laurentkempe"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://flickr.com/photos/laurentkempe/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Flickr"
                        >
                        <i class="sidebar-button-icon fab fa-flickr" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Flickr</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="http://feeds.feedburner.com/laurentkempe"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
        <div class="post-header-cover
                    text-left
                    post-header-cover--partial"
             style="background-image:url('https://farm6.staticflickr.com/5257/5561493976_859ff775f3_b.jpg');"
             data-behavior="5">
            
                <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            Running your TeamCity builds from PowerShell for any Git branch
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2012-02-07T00:09:02+00:00">
	
		    Feb 07, 2012
    	
    </time>
    
</div>

    
</div>

            
        </div>

            <div id="main" data-behavior="5"
                 class="hasCover
                        hasCoverMetaIn
                        hasCoverCaption">
                
<article class="post">
    
        <span class="post-header-cover-caption caption">Plage le long de la Savane des Pétrifications, Martinique</span>
    
    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <!-- [![Plage le long de la Savane des Pétrifications](http://farm6.staticflickr.com/5257/5561493976_859ff775f3_m.jpg)](http://www.flickr.com/photos/laurentkempe/5561493976/ "Plage le long de la Savane des Pétrifications by Laurent Kempé, on Flickr") -->  

<p>I love <a target="_blank" rel="noopener" href="http://www.jetbrains.com/teamcity/">TeamCity</a> and use it since a while to automate my build/release processes. As human we should never do the work a machine can do, we have certainly better and more interesting things to do.</p>
<a id="more"></a>

<p>The habit I saw in the different projects I worked for is to create new TeamCity builds for the branches you work on. It take quite some work to do, even with templates…</p>
<p>So I came with another way of doing it. It is leverage Git, PowerShell and the possibility to run TeamCity builds by “<a target="_blank" rel="noopener" href="http://confluence.jetbrains.net/display/TCD6/Accessing+Server+by+HTTP">Accessing Server by HTTP</a>”. Basically you just need to make a HTTP request to an Url like this:</p>
<blockquote>
<p><code>http:``//testuser:testpassword@teamcity.jetbrains.com/httpAuth/action.html?add2Queue=bt10&amp;system.name=&lt;property name1&gt;&amp;system.value=&lt;value1&gt;&amp;system.name=&lt;property name2&gt;&amp;system.value=&lt;value2&gt;&amp;env.name=&lt;environment variable name1&gt;&amp;env.value=&lt;environment variable value1&gt;&amp;env.name=&lt;environment variable name2&gt;&amp;env.value=&lt;environment variable value2&gt;</code></p>
</blockquote>
<p>We will also use the possibility to pass custom parameters (system properties and environment variables) through the HTTP request.</p>
<p>The parameter we want to pass is the Ref name of the Git VCS Root, so we start by setting it using a configuration parameter called <strong>BuildRefName</strong>, as this:</p>
<p> <a target="_blank" rel="noopener" href="http://www.flickr.com/photos/laurentkempe/6830300407/" title="Git, PowerShell, TeamCity by Laurent Kempé, on Flickr"><img src="http://farm8.staticflickr.com/7005/6830300407_f835d6002f_o.png" alt="Git, PowerShell, TeamCity"></a>   </p>
<p>Then we need to add a configuration parameters for our TeamCity project with the name <strong>BuildRefName</strong> which we currently set to <strong>master</strong>, so that if the parameter is not defined it will default to this value:<br> <a target="_blank" rel="noopener" href="http://www.flickr.com/photos/laurentkempe/6830361585/" title="Git, PowerShell, TeamCity 2 by Laurent Kempé, on Flickr"><img src="http://farm8.staticflickr.com/7164/6830361585_d10f7c0f3a_o.png" alt="Git, PowerShell, TeamCity 2"></a>   </p>
<p>Now that we have configured this you can already start a build from your browser by calling the URL!</p>
<blockquote>
<p><code>http:``//testuser:testpassword@teamcity.jetbrains.com/httpAuth/action.html?add2Queue=bt10</code></p>
</blockquote>
<p>Be sure to replace bt10 with your build id.</p>
<p>Nice ,but we want to get a step further and be able to start the build from PowerShell, which is quite easy!</p>
<p>To achieve this goal you add those two functions to your PowerShell profile:</p>
<figure class="highlight powershell"><figcaption><span>Microsoft.PowerShell_profile.ps1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Get-Web</span><span class="params">(<span class="variable">$url</span>, </span></span></span><br><span class="line"><span class="function"><span class="params">    [switch]<span class="variable">$self</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="variable">$credential</span>, </span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="variable">$toFile</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">    [switch]<span class="variable">$bytes</span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">#<span class="doctag">.Synopsis</span></span></span><br><span class="line">    <span class="comment">#    Downloads a file from the web</span></span><br><span class="line">    <span class="comment">#<span class="doctag">.Description</span></span></span><br><span class="line">    <span class="comment">#    Uses System.Net.Webclient (not the browser) to download data</span></span><br><span class="line">    <span class="comment">#    from the web.</span></span><br><span class="line">    <span class="comment">#<span class="doctag">.Parameter self</span></span></span><br><span class="line">    <span class="comment">#    Uses the default credentials when downloading that page (for downloading intranet pages)</span></span><br><span class="line">    <span class="comment">#<span class="doctag">.Parameter credential</span></span></span><br><span class="line">    <span class="comment">#    The credentials to use to download the web data</span></span><br><span class="line">    <span class="comment">#<span class="doctag">.Parameter url</span></span></span><br><span class="line">    <span class="comment">#    The page to download (e.g. www.msn.com)    </span></span><br><span class="line">    <span class="comment">#<span class="doctag">.Parameter toFile</span></span></span><br><span class="line">    <span class="comment">#    The file to save the web data to</span></span><br><span class="line">    <span class="comment">#<span class="doctag">.Parameter bytes</span></span></span><br><span class="line">    <span class="comment">#    Download the data as bytes   </span></span><br><span class="line">    <span class="comment">#<span class="doctag">.Example</span></span></span><br><span class="line">    <span class="comment">#    # Downloads www.live.com and outputs it as a string</span></span><br><span class="line">    <span class="comment">#    Get-Web http://www.live.com/</span></span><br><span class="line">    <span class="comment">#<span class="doctag">.Example</span></span></span><br><span class="line">    <span class="comment">#    # Downloads www.live.com and saves it to a file</span></span><br><span class="line">    <span class="comment">#    Get-Web http://wwww.msn.com/ -toFile www.msn.com.html</span></span><br><span class="line">    <span class="variable">$webclient</span> = <span class="built_in">New-Object</span> Net.Webclient</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$credential</span>) &#123;</span><br><span class="line">        <span class="variable">$webClient</span>.Credentials = <span class="variable">$credential</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$self</span>) &#123;</span><br><span class="line">        <span class="variable">$webClient</span>.UseDefaultCredentials = <span class="variable">$true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$toFile</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="operator">-not</span> <span class="string">&quot;<span class="variable">$toFile</span>&quot;</span>.Contains(<span class="string">&quot;:&quot;</span>)) &#123;</span><br><span class="line">            <span class="variable">$toFile</span> = <span class="built_in">Join-Path</span> <span class="variable">$pwd</span> <span class="variable">$toFile</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$webClient</span>.DownloadFile(<span class="variable">$url</span>, <span class="variable">$toFile</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$bytes</span>) &#123;</span><br><span class="line">            <span class="variable">$webClient</span>.DownloadData(<span class="variable">$url</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$webClient</span>.DownloadString(<span class="variable">$url</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tcBuild</span><span class="params">([string]<span class="variable">$branch</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$url</span> = <span class="string">&quot;http://YourServerUrl/httpAuth/action.html?add2Queue=YourBuildId&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$branch</span>) &#123;</span><br><span class="line">        <span class="variable">$url</span> = <span class="variable">$url</span> + <span class="string">&quot;&amp;name=BuildRefName&amp;value=&quot;</span> + <span class="variable">$branch</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$credentials</span> = <span class="built_in">New-Object</span> System.Net.NetworkCredential(<span class="string">&quot;Username&quot;</span>, <span class="string">&quot;Password&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Get-Web</span> <span class="variable">$url</span> <span class="literal">-credential</span> <span class="variable">$credentials</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Please adapt the tcBuild script by replacing the YourServerUrl, YourBuildId, Username, Password by your personal values.</p>
<p>The first function Get-Web is from this blog post: “<a target="_blank" rel="noopener" href="http://blogs.msdn.com/b/mediaandmicrocode/archive/2008/12/01/microcode-powershell-scripting-tricks-scripting-the-web-part-1-get-web.aspx">Microcode: PowerShell Scripting Tricks: Scripting The Web (Part 1) (Get-Web)</a>”.</p>
<p>The second, <strong>tcBuild</strong>, is quite easy and is the one you will use to start a build on the TeamCity server.</p>
<p>My workflow now is the following one:</p>
<ol>
<li>I commit on my local Git repository then </li>
<li>when I want to run a build I push to the centralized Git origin repository in my branch then </li>
<li>I start my build on the Git Branch from PowerShell by typing : </li>
</ol>
<blockquote>
<p>tcBuild Jobping-10-NewFeature</p>
</blockquote>
<p>where Jobping-10-NewFeature is the name of my Git branch.</p>
<p>This is quite cool and give me also the possibility to run kind of personal builds!</p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/Agile/" rel="tag">Agile</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Git/" rel="tag">Git</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/PowerShell/" rel="tag">PowerShell</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Productivity/" rel="tag">Productivity</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Team-City/" rel="tag">Team City</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2012/02/07/Starting-TeamCity-builds-from-HipChat-using-Github-Hubot/"
                    data-tooltip="Starting TeamCity builds from HipChat using Github Hubot"
                    aria-label="PREVIOUS: Starting TeamCity builds from HipChat using Github Hubot"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2012/01/20/Improved-development-workflow/"
                    data-tooltip="Improved my development workflow"
                    aria-label="NEXT: Improved my development workflow"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/"
                    title="global.share_on_linkedin"
                    aria-label="global.share_on_linkedin"
                >
                    <i class="fab fa-linkedin" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 Laurent Kempé. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2012/02/07/Starting-TeamCity-builds-from-HipChat-using-Github-Hubot/"
                    data-tooltip="Starting TeamCity builds from HipChat using Github Hubot"
                    aria-label="PREVIOUS: Starting TeamCity builds from HipChat using Github Hubot"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2012/01/20/Improved-development-workflow/"
                    data-tooltip="Improved my development workflow"
                    aria-label="NEXT: Improved my development workflow"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/"
                    title="global.share_on_linkedin"
                    aria-label="global.share_on_linkedin"
                >
                    <i class="fab fa-linkedin" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/"
                        aria-label="global.share_on_linkedin"
                    >
                        <i class="fab fa-linkedin" aria-hidden="true"></i><span>global.share_on_linkedin</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="https://farm2.staticflickr.com/1971/31306281378_02b055ccfe_q.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Laurent Kempé</h4>
        
            <div id="about-card-bio"><p>I am an experienced Team Leader &amp; Distinguished Solution Architect with a passion for shipping high-quality products by empowering development team and culture toward an agile mindset. I bring technical vision and strategy, leading engineering teams to move product, processes and architecture forward.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Team Leader, Distinguished Solutions Architect</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Illzach, France
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('https://farm5.staticflickr.com/4437/37116073235_dda239221d_o.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-cplrxp0mqheqlobxh18brjz8hbdxwdehunbxsgqf3duixik1bs2qc7xnzkch.min.js"></script>

<!--SCRIPTS END-->


    
        <script>
          var disqus_config = function() {
            this.page.url = 'https://laurentkempe.com/2012/02/07/Running-your-TeamCity-builds-from-a-command-line/';
              
            this.page.identifier = '20120207010902';
              
          };
          (function() {
            var d = document, s = d.createElement('script');
            var disqus_shortname = 'laurentkempe';
            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
    




    </body>
</html>
